import{a as d,t as y,d as T}from"../chunks/disclose-version.BTBZDN_a.js";import{V as B,Z as u,$ as c,_ as v,X as D,Y as H,a6 as P,K as Q,W as F,P as n,a9 as R}from"../chunks/runtime.9UtlaTIT.js";import{d as X,s as V}from"../chunks/render.D2Ug7jGZ.js";import{a as A,p as S,i as W}from"../chunks/preload-helper.B1TkqzSX.js";import{r as z,b as $,c as N,s as J}from"../chunks/attributes.DbpSsg2k.js";import{s as ee}from"../chunks/snippet.CnSabrQc.js";import{I as K,s as Y,M as se,o as te}from"../chunks/Icon.DzZZ7ctA.js";import{M as ae}from"../chunks/Editor.pJaPhhzk.js";import{s as oe}from"../chunks/Plot.CfTS8oI1.js";import{e as re,i as ie}from"../chunks/each.B2u7wc9R.js";var ne=(s,e)=>e(!e()),ce=y('<div class="card svelte-1ieggam"><input class="checkbox svelte-1ieggam" type="checkbox"> <!> <span class="label svelte-1ieggam"> </span></div>');function L(s,e){B(e,!0);let t=A(e,"checked",15);var r=ce();r.__click=[ne,t];var l=u(r);z(l);var a=c(l,2);ee(a,()=>e.icon);var i=c(a,2),m=u(i,!0);v(i),v(r),D(()=>{$(l,t()),V(m,e.label)}),d(s,r),H()}X(["click"]);var le=y('<div class="objectives svelte-1bb90me"><!> <!> <!></div>');function ve(s,e){let t=A(e,"cost",15),r=A(e,"emissions",15),l=A(e,"risk",15);var a=le(),i=u(a);L(i,{label:"Price",get checked(){return t()},set checked(o){t(o)},icon:o=>{K(o,{icon:"twemoji:dollar-banknote"})},$$slots:{icon:!0}});var m=c(i,2);L(m,{label:"Emissions",get checked(){return r()},set checked(o){r(o)},icon:o=>{K(o,{icon:"fa:leaf",style:"color: #4CAF50;"})},$$slots:{icon:!0}});var q=c(m,2);L(q,{label:"Risk",get checked(){return l()},set checked(o){l(o)},icon:o=>{K(o,{icon:"fluent-emoji-flat:police-car-light"})},$$slots:{icon:!0}}),v(a),d(s,a)}function ue(s){const e=JSON.stringify(s.map(([i])=>i.name)),t=JSON.stringify(s.map(([,i])=>i)),r="```",l=Y(s.map(([i,m])=>i.cost*m)).toFixed(2),a=Y(s.map(([i,m])=>i.emissions*m)).toFixed(2);return`

# Optimization Results

## Optimal Energy Mix

${r}plot
{
  "data": [
    {
      "labels": ${e},
      "values": ${t},
      "type": "pie",
      "hole": 0.3,
      "textinfo": "label+percent",
      "name": "Energy Sources"
    }
  ],
  "layout": {
    "showlegend": false,
    "margin": {"l": 20, "r": 20, "t": 20, "b": 20}
  }
}
${r}

## Key Performance Indicators

| **Metric**               | **Value**         |
|---------------------------|-------------------|
| Weighted Cost            | ${l}€/MWh        |
| Weighted Carbon Intensity | ${a} gCO2eq/kWh |

`}const me=se({baseUrl:"http://localhost:8000"});var _e=y("<p>Loading...</p>"),de=y("<p>Error</p>"),be=y("<p>Impossible</p>");function ge(s,e){B(e,!0);let t=P(S({tag:"loading"}));async function r(){console.log("Optimizing portfolio");const _=await te({client:me,throwOnError:!1,body:{goals:{cheap:e.cost?1:0,green:e.emissions?1:0,safe:e.risk?1:0},sources:e.sources,constraints:{}}});if(_.error)R(t,S({tag:"error"}));else if(_.data){const o=_.data,O=e.sources.map((h,p)=>[h,o[p]]).filter(([h,p])=>p>0);console.log("Optimized portfolio",O),R(t,S({tag:"success",proportions:o,markdown:ue(O)}))}else R(t,S({tag:"impossible"}))}Q(()=>{r()});const l={table:{headerBg:"#444",oddRowBg:"#2b2b2b",oddRowFontColor:"var(--color-text)",oddRowHover:"#333",evenRowBg:"#1e1e1e",evenRowFontColor:"var(--color-text)",evenRowHover:"#333",border:"1px solid #444"},text:{h1Color:"var(--color-h1)",h2Color:"white"},plot:{paper_bgcolor:"#1b2925",font:{color:"#d4f0e4"},fillParent:"width"}};var a=T(),i=F(a);{var m=_=>{var o=_e();d(_,o)},q=_=>{var o=T(),O=F(o);{var h=b=>{var w=de();d(b,w)},p=b=>{var w=T(),g=F(w);{var k=f=>{var x=be();d(f,x)},C=f=>{var x=T(),j=F(x);{var M=E=>{ae(E,{theme:l,get markdown(){return n(t).markdown}})};W(j,E=>{n(t).tag==="success"&&E(M)},!0)}d(f,x)};W(g,f=>{n(t).tag==="impossible"?f(k):f(C,!1)},!0)}d(b,w)};W(O,b=>{n(t).tag==="error"?b(h):b(p,!1)},!0)}d(_,o)};W(i,_=>{n(t).tag==="loading"?_(m):_(q,!1)})}d(s,a),H()}var fe=(s,e)=>{R(e,!n(e))},pe=(s,e)=>e.setSource({...e.source,p_min:+s.currentTarget.value}),ke=(s,e)=>e.setSource({...e.source,p_max:+s.currentTarget.value}),xe=(s,e)=>e.setSource({...e.source,cost:+s.currentTarget.value}),he=(s,e)=>e.setSource({...e.source,emissions:+s.currentTarget.value}),we=(s,e)=>e.setSource({...e.source,risk:+s.currentTarget.value}),ye=y('<div class="accordion svelte-1bl7qwx"><div class="accordion-summary svelte-1bl7qwx"><strong> </strong> <span> </span></div> <div><label class="svelte-1bl7qwx"><span>Minimum Proportion:</span> <input type="number" min="0" max="1" step="0.01" class="svelte-1bl7qwx"></label> <label class="svelte-1bl7qwx">Maximum Proportion: <input type="number" min="0" max="1" step="0.01" class="svelte-1bl7qwx"></label> <label class="svelte-1bl7qwx">Cost: <input type="number" class="svelte-1bl7qwx"></label> <label class="svelte-1bl7qwx">Emissions: <input type="number" class="svelte-1bl7qwx"></label> <label class="svelte-1bl7qwx">Risk: <input type="number" class="svelte-1bl7qwx"></label></div></div>');function Oe(s,e){B(e,!0);let t=P(!1);var r=ye(),l=u(r);l.__click=[fe,t];var a=u(l),i=u(a,!0);v(a);var m=c(a,2),q=u(m);v(m),v(l);var _=c(l,2),o=u(_),O=c(u(o),2);z(O),O.__input=[pe,e],v(o);var h=c(o,2),p=c(u(h));z(p),p.__input=[ke,e],v(h);var b=c(h,2),w=c(u(b));z(w),w.__input=[xe,e],v(b);var g=c(b,2),k=c(u(g));z(k),k.__input=[he,e],v(g);var C=c(g,2),f=c(u(C));z(f),f.__input=[we,e],v(C),v(_),v(r),D(()=>{V(i,e.source.name),V(q,`${e.source.cost??""} €/kWh, ${e.source.emissions??""} gCO₂/MWh`),oe(_,`${`accordion-details ${n(t)?"":"hidden"}`??""} svelte-1bl7qwx`),N(O,e.source.p_min??0),N(p,e.source.p_max??1),N(w,e.source.cost),N(k,e.source.emissions),N(f,e.source.risk)}),d(s,r),H()}X(["click","input"]);var Se=y('<div class="sources-container svelte-afdh44"></div>');function qe(s,e){B(e,!0);const t=A(e,"sources",15);var r=Se();re(r,21,t,ie,(l,a,i)=>{Oe(l,{get source(){return n(a)},setSource:m=>t(t()[i]=m,!0)})}),v(r),d(s,r),H()}const Ce=[{name:"Coal",cost:50,emissions:100,risk:10,p_max:.1},{name:"Natural Gas",cost:40,emissions:50,risk:5,p_max:.3},{name:"Solar",cost:30,emissions:10,risk:1,p_max:.6},{name:"Wind",cost:20,emissions:5,risk:.5,p_max:.8},{name:"Hydro",cost:10,emissions:2,risk:.1,p_max:1},{name:"Nuclear",cost:60,emissions:20,risk:2,p_max:.2},{name:"Oil",cost:45,emissions:80,risk:8,p_max:.2},{name:"Geothermal",cost:25,emissions:10,risk:1,p_max:.5}];var Re=(s,e)=>e("results"),je=y('<div class="objectives-tab svelte-1evw29x"><h2>Objectives</h2> <!> <button class="svelte-1evw29x">Optimize</button></div>'),Me=y('<div class="sources-tab svelte-1evw29x"><h2>Sources</h2> <div class="sources-scroll svelte-1evw29x"><!></div></div>'),Ee=y('<div class="results-tab"><!></div>'),Pe=(s,e)=>e("objectives"),We=(s,e)=>e("sources"),ze=(s,e)=>e("results"),Te=y('<div class="container svelte-1evw29x"><main class="svelte-1evw29x"><h1>Portfolio Optimization</h1> <!></main> <footer class="svelte-1evw29x"><button class="svelte-1evw29x">Objectives</button> <button class="svelte-1evw29x">Sources</button> <button class="svelte-1evw29x">Results</button></footer></div>');function Le(s){let e=P(S(Ce)),t=P(!1),r=P(!1),l=P(!1),a=P("objectives");function i(g){R(a,S(g))}var m=Te(),q=u(m),_=c(u(q),2);{var o=g=>{var k=je(),C=c(u(k),2);ve(C,{get cost(){return n(t)},set cost(x){R(t,S(x))},get emissions(){return n(r)},set emissions(x){R(r,S(x))},get risk(){return n(l)},set risk(x){R(l,S(x))}});var f=c(C,2);f.__click=[Re,i],v(k),d(g,k)},O=g=>{var k=T(),C=F(k);{var f=j=>{var M=Me(),E=c(u(M),2),U=u(E);qe(U,{get sources(){return n(e)},set sources(I){R(e,S(I))}}),v(E),v(M),d(j,M)},x=j=>{var M=T(),E=F(M);{var U=I=>{var G=Ee(),Z=u(G);ge(Z,{get cost(){return n(t)},get emissions(){return n(r)},get risk(){return n(l)},get sources(){return n(e)}}),v(G),d(I,G)};W(E,I=>{n(a)==="results"&&I(U)},!0)}d(j,M)};W(C,j=>{n(a)==="sources"?j(f):j(x,!1)},!0)}d(g,k)};W(_,g=>{n(a)==="objectives"?g(o):g(O,!1)})}v(q);var h=c(q,2),p=u(h);p.__click=[Pe,i];var b=c(p,2);b.__click=[We,i];var w=c(b,2);w.__click=[ze,i],v(h),v(m),D(()=>{J(p,"style",n(a)==="objectives"?"background: var(--color-accent-2);":""),J(b,"style",n(a)==="sources"?"background: var(--color-accent-2);":""),J(w,"style",n(a)==="results"?"background: var(--color-accent-2);":"")}),d(s,m)}X(["click"]);export{Le as component};
