import{a as p,t as y,d as X}from"../chunks/disclose-version.BTBZDN_a.js";import{Z as h,_ as c,$ as f,X as K,P as i,V as O,Y as S,a6 as j,K as z,a9 as w,W as N}from"../chunks/runtime.9UtlaTIT.js";import{d as B,s as P}from"../chunks/render.D2Ug7jGZ.js";import{a as F,p as M,i as W}from"../chunks/preload-helper.B1TkqzSX.js";import{e as G,i as H}from"../chunks/each.B2u7wc9R.js";import{t as J,P as Q}from"../chunks/Plot.CfTS8oI1.js";const I=[{name:"OMIE Intra-Day",id:"omie-intra-day",location:"Iberian Peninsula",unit:"€/MWh"},{name:"OMIE Day-Ahead",id:"omie-day-ahead",location:"Iberian Peninsula",unit:"€/MWh"},{name:"EPEX SPOT Intra-Day",id:"epex-spot-intra-day",location:"Central Europe",unit:"€/MWh"},{name:"EPEX SPOT Day-Ahead",id:"epex-spot-day-ahead",location:"Central Europe",unit:"€/MWh"},{name:"N2EX Intra-Day",id:"n2ex-intra-day",location:"UK",unit:"£/MWh"},{name:"N2EX Day-Ahead",id:"n2ex-day-ahead",location:"UK",unit:"£/MWh"},{name:"Nord Pool Intra-Day",id:"nord-pool-intra-day",location:"Nordic Countries",unit:"€/MWh"},{name:"Nord Pool Day-Ahead",id:"nord-pool-day-ahead",location:"Nordic Countries",unit:"€/MWh"},{name:"EEX Intra-Day",id:"eex-intra-day",location:"Central Europe",unit:"€/MWh"},{name:"EEX Day-Ahead",id:"eex-day-ahead",location:"Central Europe",unit:"€/MWh"}];var $=y('<button class="svelte-3geip2"><strong class="svelte-3geip2"> </strong> <span class="svelte-3geip2"> </span></button>'),ee=y('<div class="svelte-3geip2"></div>');function ae(r,a){let t=F(a,"selected",15);var n=ee();G(n,21,()=>a.markets,H,(o,s,l)=>{var e=$();e.__click=()=>t(l);var m=h(e),v=h(m,!0);c(m);var x=f(m,2),D=h(x,!0);c(x),c(e),K(()=>{J(e,"active",l===t()),P(v,i(s).name),P(D,i(s).location)}),p(o,e)}),c(n),p(r,n)}B(["click"]);const T=r=>Array.from({length:r},(a,t)=>t),E=7*24*60*60*1e3;function te(r,a,t){const o=r%2===0?1:-1;return{interval:[new Date(t+r*E),new Date(t+(r+1)*E)],open:a,close:a+o*Math.random()*100,high:a+o*Math.random()*100,low:a+o*Math.random()*100}}function ne(r,a,t){const o=r%2===0?1:-1;return{time:new Date(t+r*E),price:a+o*Math.random()*100}}function re(r,a){const t=Date.now()-r*E,n=T(r).reduce((e,m)=>{const v=e.length>0?e[e.length-1].close:500;return[...e,te(m,v,t)]},[]),o=n.map(e=>({time:e.interval[0],price:(e.high+e.low)/2})),s=T(a).reduce((e,m)=>{const v=e.length>0?e[e.length-1].price:o[o.length-1].price;return[...e,ne(m,v,n[n.length-1].interval[1].getTime())]},[]),l=[...o,...s];return[n,l]}function oe(r,a){O(a,!0);const t={type:"candlestick",name:"Market",x:a.candles.map(e=>e.interval[0]),close:a.candles.map(e=>e.close),high:a.candles.map(e=>e.high),low:a.candles.map(e=>e.low),open:a.candles.map(e=>e.open),xaxis:"x",yaxis:"y"},n={type:"scatter",mode:"lines+markers",name:"Predictions",x:a.preds.map(e=>e.time),y:a.preds.map(e=>e.price)},o=[t,n],s=Math.min(10,a.candles.length),l={dragmode:"pan",selectdirection:"h",xaxis:{type:"date",rangeslider:{visible:!1},range:[a.candles[a.candles.length-s].interval[0],a.candles[a.candles.length-1].interval[1]]},paper_bgcolor:"#1b2925",plot_bgcolor:"#1b2925",modebar:{},margin:{l:30,r:0,t:0,b:0,pad:0},font:{color:"#d4f0e4"},legend:{orientation:"h",xanchor:"left",yanchor:"top",y:-.2,x:0}};Q(r,{data:o,layout:l,fillParent:"width",config:{displayModeBar:!1,displaylogo:!1}}),S()}var ie=y("<p>Loading...</p>"),se=y("<p>Error fetching data</p>"),le=y('<main class="svelte-1f47jpp"><h1 class="svelte-1f47jpp">Market Predictions</h1> <div class="card svelte-1f47jpp"><h2> </h2> <h3 class="svelte-1f47jpp"> </h3> <!></div> <div class="card svelte-1f47jpp"><h2 style="margin-bottom: 1rem;">Markets</h2> <div class="markets svelte-1f47jpp"><!></div></div></main>');function ge(r,a){O(a,!0);let t=j(M({tag:"loading"})),n=j(0);async function o(){w(t,M({tag:"loading"})),i(n),await new Promise(b=>setTimeout(b,0));const[d,g]=re(25,25);w(t,M({tag:"loaded",candles:d,preds:g}))}z(()=>{o()});var s=le(),l=f(h(s),2),e=h(l),m=h(e,!0);c(e);var v=f(e,2),x=h(v,!0);c(v);var D=f(v,2);{var U=d=>{var g=ie();p(d,g)},L=d=>{var g=X(),b=N(g);{var V=u=>{var _=se();p(u,_)},Y=u=>{var _=X(),Z=N(_);{var q=k=>{oe(k,{get candles(){return i(t).candles},get preds(){return i(t).preds}})};W(Z,k=>{i(t).tag==="loaded"&&k(q)},!0)}p(u,_)};W(b,u=>{i(t).tag==="error"?u(V):u(Y,!1)},!0)}p(d,g)};W(D,d=>{i(t).tag==="loading"?d(U):d(L,!1)})}c(l);var C=f(l,2),A=f(h(C),2),R=h(A);ae(R,{markets:I,get selected(){return i(n)},set selected(d){w(n,M(d))}}),c(A),c(C),c(s),K(()=>{P(m,I[i(n)].name),P(x,I[i(n)].unit)}),p(r,s),S()}export{ge as component};
